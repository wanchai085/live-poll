<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ผลโหวตและเหตุผล (สด)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');
        
        :root {
            --color-time: #3498db;
            --color-fear: #e74c3c;
            --color-support: #2ecc71;
            --color-other: #9b59b6;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 10px; /* ลด padding สำหรับมือถือ */
            color: #333;
        }
        .container {
            display: flex;
            flex-direction: column; /* ค่าเริ่มต้นเป็นแนวตั้งสำหรับมือถือ */
            gap: 20px;
            width: 100%;
            max-width: 1400px;
            margin: auto;
        }
        .sidebar-column, .main-column {
            width: 100%;
        }
        .sidebar-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .card {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            font-size: 1.4em;
        }

        /* --- Styling for Summary Cards --- */
        .results { margin-top: 20px; }
        .result-item { margin-bottom: 18px; }
        .result-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: bold; font-size: 0.95em; }
        .result-bar-container { background-color: #ecf0f1; border-radius: 20px; height: 22px; overflow: hidden;}
        .result-bar-inner { height: 100%; width: 0%; border-radius: 20px; transition: width 0.5s ease-in-out; text-align: right; color: white; font-size: 12px; line-height: 22px; padding-right: 10px; box-sizing: border-box;}
        #option1-bar { background: var(--color-time); }
        #option2-bar { background: var(--color-fear); }
        #option3-bar { background: var(--color-support); }
        .other-votes-list { list-style-type: none; padding: 0; }
        .other-votes-list li { display: flex; justify-content: space-between; padding: 10px 5px; border-bottom: 1px solid #f0f0f0; }
        .other-votes-list li:last-child { border-bottom: none; }
        .other-votes-list span:first-child { font-weight: bold; color: var(--color-other); }

        /* --- Styling for Main Reason Feed --- */
        .reasons-container {
            height: auto; /* บนมือถือให้ความสูงเป็นไปตามเนื้อหา */
        }
        .reasons-feed {
            /* ไม่ต้องกำหนดความสูงตายตัวบนมือถือ */
        }
        .reason-card {
            background: #ffffff;
            border: 1px solid #e9e9e9;
            border-left-width: 6px;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .reason-card p.reason-text {
            font-size: 1.1em;
            margin: 0 0 10px 0;
            line-height: 1.5;
            color: #2c3e50;
        }
        .reason-card .meta {
            font-size: 0.85em;
            color: #7f8c8d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .reason-card .meta .choice { font-weight: bold; }
        .reason-card.option1 .meta .choice { color: var(--color-time); }
        .reason-card.option2 .meta .choice { color: var(--color-fear); }
        .reason-card.option3 .meta .choice { color: var(--color-support); }
        .reason-card.option_other .meta .choice { color: var(--color-other); }

        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.8) translateY(20px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* --- MEDIA QUERY FOR DESKTOP --- */
        /* เมื่อหน้าจอกว้างกว่า 992px ให้ใช้สไตล์นี้ */
        @media (min-width: 992px) {
            body {
                padding: 25px; /* เพิ่ม padding กลับมา */
            }
            .container {
                flex-direction: row-reverse; /* กลับไปเป็น 2 คอลัมน์ */
            }
            .main-column {
                flex: 2.5;
            }
            .sidebar-column {
                flex: 1;
            }
            .reasons-container {
                height: 85vh; /* กำหนดความสูงให้ฟีดเลื่อนได้ */
                display: flex;
                flex-direction: column;
            }
            .reasons-feed {
                overflow-y: auto; /* ทำให้เลื่อนได้ */
                flex-grow: 1;
                padding-right: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- เนื้อหา HTML และ JavaScript เหมือนเดิม ไม่มีการเปลี่ยนแปลง -->
    <div class="container">
        <div class="sidebar-column">
            <div class="card poll-container">
                <!-- ... โค้ดเดิมสำหรับกราฟสรุป ... -->
            </div>
            <div class="card other-votes-container">
                 <!-- ... โค้ดเดิมสำหรับรายการอื่นๆ ... -->
            </div>
        </div>
        <div class="main-column">
            <div class="card reasons-container">
                <!-- ... โค้ดเดิมสำหรับฟีดเหตุผล ... -->
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = { /* วาง Config ของคุณที่นี่ */ };
        // ... JavaScript ทั้งหมดเหมือนเดิม ...
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const optionMap = { /* ... โค้ดเดิม ... */ };
        database.ref('votes').on('value', snapshot => { /* ... โค้ดเดิม ... */ });
        database.ref('reasons').orderByChild('timestamp').limitToLast(50).on('child_added', snapshot => { /* ... โค้ดเดิม ... */ });
        database.ref('other_votes').orderByChild('count').on('value', snapshot => { /* ... โค้ดเดิม ... */ });
        function updateVoteCounts(votes) { /* ... โค้ดเดิม ... */ }
        function addReasonToFeed(data) { /* ... โค้ดเดิม ... */ }
        function updateOtherVotes(votes) { /* ... โค้ดเดิม ... */ }
    </script>
</body>
</html>
